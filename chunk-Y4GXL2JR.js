import{a,b as r,d as i,s as c}from"./chunk-TNYZ2SDM.js";var d=(()=>{class n{constructor(){this.STORAGE_KEY="pokemon-search-state",this.initialState={query:"",selectedPokemon:null,encounters:[],isLoading:!1,error:null,pagination:{currentPage:1,itemsPerPage:10,totalItems:0}},this.stateSubject=new i(this.loadStateFromStorage()),this.stateSubject.subscribe(t=>{this.saveStateToStorage(t)})}getState(){return this.stateSubject.asObservable()}getCurrentState(){return this.stateSubject.value}setSearchQuery(t){let e=this.getCurrentState();this.updateState(r(a({},e),{query:t,error:null}))}setSelectedPokemon(t){let e=this.getCurrentState();this.updateState(r(a({},e),{selectedPokemon:t,encounters:[],error:null,pagination:r(a({},e.pagination),{currentPage:1,totalItems:0})}))}setLoading(t){let e=this.getCurrentState();this.updateState(r(a({},e),{isLoading:t,error:t?null:e.error}))}setEncounters(t){let e=this.getCurrentState();this.updateState(r(a({},e),{encounters:t,isLoading:!1,error:null,pagination:r(a({},e.pagination),{currentPage:1,totalItems:t.length})}))}setError(t){let e=this.getCurrentState();this.updateState(r(a({},e),{error:t,isLoading:!1}))}setPagination(t){let e=this.getCurrentState();this.updateState(r(a({},e),{pagination:a(a({},e.pagination),t)}))}clearState(){this.updateState(this.initialState),localStorage.removeItem(this.STORAGE_KEY)}clearResults(){let t=this.getCurrentState();this.updateState(r(a({},t),{selectedPokemon:null,encounters:[],error:null,isLoading:!1,pagination:r(a({},t.pagination),{currentPage:1,totalItems:0})}))}getPaginatedEncounters(){let t=this.getCurrentState(),{encounters:e,pagination:u}=t,{currentPage:l,itemsPerPage:s}=u,o=(l-1)*s,S=o+s;return e.slice(o,S)}hasResults(){return this.getCurrentState().encounters.length>0}isLoading(){return this.getCurrentState().isLoading}hasError(){return!!this.getCurrentState().error}updateState(t){this.stateSubject.next(t)}loadStateFromStorage(){try{let t=localStorage.getItem(this.STORAGE_KEY);if(t){let e=JSON.parse(t);return r(a(a({},this.initialState),e),{isLoading:!1,error:null})}}catch(t){console.warn("Failed to load state from localStorage:",t),localStorage.removeItem(this.STORAGE_KEY)}return this.initialState}saveStateToStorage(t){try{let e=r(a({},t),{isLoading:!1,error:null});localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(e){console.warn("Failed to save state to localStorage:",e)}}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{d as a};
